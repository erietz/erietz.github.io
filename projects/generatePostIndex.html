<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <link rel="stylesheet" href="/assets/css/master.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <meta name="viewport" content="width=device-width" />
    <title>Generate Post Index File</title>
  </head>
  <body>

    <script src="/assets/js/navigation.js" charset="utf-8"></script>

    <h1>Posts</h1>

    <p>
    A list of posts on this website dynamically generated from client side
    javascript using the Github API
    </p>

    <script charset="utf-8">
        const list = document.createElement('UL');
        list.innerHTML = '';

        fetch('https://api.github.com/repos/erietz/erietz.github.io/contents/posts')
          .then(response => response.json())
          .then(data => {
            for (let file of data) {
              const listItem = '<li>' + `<a href="/${file.path}" >`  + file.name + '</a>' + '</li>';
              list.innerHTML += listItem
            }
          })
          .catch(error => console.log(error));
        document.body.appendChild(list);
    </script>

    For a real recursive headache, the content of this file is include here...

    <script>
      fetch('https://raw.githubusercontent.com/erietz/erietz.github.io/master/projects/generatePostIndex.html')
        .then(response => response.text())
        .then(data => {
          console.log(data)
          const code = document.createElement('pre')
          code.textContent = data
          document.body.appendChild(code)
        })
    </script>

    <script src="/assets/js/footer.js" charset="utf-8"></script>
  </body>
</html>
